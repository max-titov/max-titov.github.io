<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">ol.lst-kix_kgugg8j2ftt9-6{list-style-type:none}ol.lst-kix_kgugg8j2ftt9-5{list-style-type:none}ol.lst-kix_kgugg8j2ftt9-8{list-style-type:none}ol.lst-kix_kgugg8j2ftt9-7{list-style-type:none}ol.lst-kix_kgugg8j2ftt9-2{list-style-type:none}ol.lst-kix_kgugg8j2ftt9-1{list-style-type:none}ol.lst-kix_kgugg8j2ftt9-4{list-style-type:none}ol.lst-kix_kgugg8j2ftt9-3{list-style-type:none}.lst-kix_kgugg8j2ftt9-3>li{counter-increment:lst-ctn-kix_kgugg8j2ftt9-3}ol.lst-kix_zf9przpwvhgy-1.start{counter-reset:lst-ctn-kix_zf9przpwvhgy-1 0}ol.lst-kix_kgugg8j2ftt9-0{list-style-type:none}.lst-kix_kgugg8j2ftt9-4>li{counter-increment:lst-ctn-kix_kgugg8j2ftt9-4}ol.lst-kix_kgugg8j2ftt9-6.start{counter-reset:lst-ctn-kix_kgugg8j2ftt9-6 0}.lst-kix_zf9przpwvhgy-4>li{counter-increment:lst-ctn-kix_zf9przpwvhgy-4}ol.lst-kix_zf9przpwvhgy-8.start{counter-reset:lst-ctn-kix_zf9przpwvhgy-8 0}.lst-kix_kgugg8j2ftt9-2>li:before{content:"" counter(lst-ctn-kix_kgugg8j2ftt9-2,decimal) ". "}.lst-kix_tlbproir1c2j-7>li:before{content:"-  "}.lst-kix_kgugg8j2ftt9-1>li:before{content:"" counter(lst-ctn-kix_kgugg8j2ftt9-1,lower-roman) ". "}.lst-kix_kgugg8j2ftt9-3>li:before{content:"" counter(lst-ctn-kix_kgugg8j2ftt9-3,lower-latin) ". "}.lst-kix_zf9przpwvhgy-7>li:before{content:"" counter(lst-ctn-kix_zf9przpwvhgy-7,lower-latin) ". "}.lst-kix_zf9przpwvhgy-8>li:before{content:"" counter(lst-ctn-kix_zf9przpwvhgy-8,lower-roman) ". "}.lst-kix_tlbproir1c2j-6>li:before{content:"-  "}.lst-kix_kgugg8j2ftt9-6>li:before{content:"" counter(lst-ctn-kix_kgugg8j2ftt9-6,lower-latin) ". "}.lst-kix_kgugg8j2ftt9-8>li{counter-increment:lst-ctn-kix_kgugg8j2ftt9-8}.lst-kix_zf9przpwvhgy-5>li{counter-increment:lst-ctn-kix_zf9przpwvhgy-5}.lst-kix_tlbproir1c2j-3>li:before{content:"-  "}.lst-kix_zf9przpwvhgy-5>li:before{content:"(" counter(lst-ctn-kix_zf9przpwvhgy-5,lower-roman) ") "}.lst-kix_zf9przpwvhgy-6>li:before{content:"" counter(lst-ctn-kix_zf9przpwvhgy-6,decimal) ". "}ol.lst-kix_kgugg8j2ftt9-0.start{counter-reset:lst-ctn-kix_kgugg8j2ftt9-0 0}ol.lst-kix_kgugg8j2ftt9-3.start{counter-reset:lst-ctn-kix_kgugg8j2ftt9-3 0}.lst-kix_kgugg8j2ftt9-7>li:before{content:"" counter(lst-ctn-kix_kgugg8j2ftt9-7,lower-roman) ". "}ol.lst-kix_zf9przpwvhgy-2.start{counter-reset:lst-ctn-kix_zf9przpwvhgy-2 0}ol.lst-kix_zf9przpwvhgy-5.start{counter-reset:lst-ctn-kix_zf9przpwvhgy-5 0}.lst-kix_kgugg8j2ftt9-0>li:before{content:"" counter(lst-ctn-kix_kgugg8j2ftt9-0,lower-latin) ". "}.lst-kix_tlbproir1c2j-5>li:before{content:"-  "}.lst-kix_kgugg8j2ftt9-8>li:before{content:"" counter(lst-ctn-kix_kgugg8j2ftt9-8,decimal) ". "}.lst-kix_tlbproir1c2j-4>li:before{content:"-  "}.lst-kix_zf9przpwvhgy-8>li{counter-increment:lst-ctn-kix_zf9przpwvhgy-8}.lst-kix_zf9przpwvhgy-2>li{counter-increment:lst-ctn-kix_zf9przpwvhgy-2}ol.lst-kix_kgugg8j2ftt9-7.start{counter-reset:lst-ctn-kix_kgugg8j2ftt9-7 0}.lst-kix_kgugg8j2ftt9-5>li:before{content:"" counter(lst-ctn-kix_kgugg8j2ftt9-5,decimal) ". "}.lst-kix_kgugg8j2ftt9-5>li{counter-increment:lst-ctn-kix_kgugg8j2ftt9-5}.lst-kix_kgugg8j2ftt9-4>li:before{content:"" counter(lst-ctn-kix_kgugg8j2ftt9-4,lower-roman) ". "}.lst-kix_tlbproir1c2j-8>li:before{content:"-  "}.lst-kix_kgugg8j2ftt9-2>li{counter-increment:lst-ctn-kix_kgugg8j2ftt9-2}.lst-kix_zf9przpwvhgy-1>li{counter-increment:lst-ctn-kix_zf9przpwvhgy-1}ol.lst-kix_zf9przpwvhgy-6.start{counter-reset:lst-ctn-kix_zf9przpwvhgy-6 0}.lst-kix_kgugg8j2ftt9-0>li{counter-increment:lst-ctn-kix_kgugg8j2ftt9-0}.lst-kix_kgugg8j2ftt9-6>li{counter-increment:lst-ctn-kix_kgugg8j2ftt9-6}ol.lst-kix_kgugg8j2ftt9-4.start{counter-reset:lst-ctn-kix_kgugg8j2ftt9-4 0}ol.lst-kix_zf9przpwvhgy-0{list-style-type:none}ol.lst-kix_kgugg8j2ftt9-8.start{counter-reset:lst-ctn-kix_kgugg8j2ftt9-8 0}ol.lst-kix_zf9przpwvhgy-2{list-style-type:none}.lst-kix_zf9przpwvhgy-1>li:before{content:"" counter(lst-ctn-kix_zf9przpwvhgy-1,lower-latin) ") "}ol.lst-kix_zf9przpwvhgy-1{list-style-type:none}.lst-kix_zf9przpwvhgy-2>li:before{content:"" counter(lst-ctn-kix_zf9przpwvhgy-2,lower-roman) ") "}.lst-kix_tlbproir1c2j-0>li:before{content:"-  "}.lst-kix_kgugg8j2ftt9-7>li{counter-increment:lst-ctn-kix_kgugg8j2ftt9-7}ol.lst-kix_zf9przpwvhgy-4{list-style-type:none}.lst-kix_kgugg8j2ftt9-1>li{counter-increment:lst-ctn-kix_kgugg8j2ftt9-1}ol.lst-kix_zf9przpwvhgy-3{list-style-type:none}ol.lst-kix_zf9przpwvhgy-3.start{counter-reset:lst-ctn-kix_zf9przpwvhgy-3 0}.lst-kix_zf9przpwvhgy-0>li:before{content:"" counter(lst-ctn-kix_zf9przpwvhgy-0,decimal) ") "}ol.lst-kix_zf9przpwvhgy-6{list-style-type:none}ul.lst-kix_tlbproir1c2j-0{list-style-type:none}.lst-kix_zf9przpwvhgy-3>li:before{content:"(" counter(lst-ctn-kix_zf9przpwvhgy-3,decimal) ") "}.lst-kix_zf9przpwvhgy-4>li:before{content:"(" counter(lst-ctn-kix_zf9przpwvhgy-4,lower-latin) ") "}ol.lst-kix_zf9przpwvhgy-5{list-style-type:none}ol.lst-kix_zf9przpwvhgy-8{list-style-type:none}.lst-kix_tlbproir1c2j-2>li:before{content:"-  "}ul.lst-kix_tlbproir1c2j-2{list-style-type:none}ol.lst-kix_zf9przpwvhgy-7{list-style-type:none}ul.lst-kix_tlbproir1c2j-1{list-style-type:none}ul.lst-kix_tlbproir1c2j-4{list-style-type:none}ul.lst-kix_tlbproir1c2j-3{list-style-type:none}ul.lst-kix_tlbproir1c2j-6{list-style-type:none}ol.lst-kix_kgugg8j2ftt9-1.start{counter-reset:lst-ctn-kix_kgugg8j2ftt9-1 0}ul.lst-kix_tlbproir1c2j-5{list-style-type:none}.lst-kix_zf9przpwvhgy-7>li{counter-increment:lst-ctn-kix_zf9przpwvhgy-7}ul.lst-kix_tlbproir1c2j-8{list-style-type:none}.lst-kix_tlbproir1c2j-1>li:before{content:"-  "}ul.lst-kix_tlbproir1c2j-7{list-style-type:none}ol.lst-kix_kgugg8j2ftt9-5.start{counter-reset:lst-ctn-kix_kgugg8j2ftt9-5 0}ol.lst-kix_zf9przpwvhgy-0.start{counter-reset:lst-ctn-kix_zf9przpwvhgy-0 0}ol.lst-kix_zf9przpwvhgy-7.start{counter-reset:lst-ctn-kix_zf9przpwvhgy-7 0}.lst-kix_zf9przpwvhgy-3>li{counter-increment:lst-ctn-kix_zf9przpwvhgy-3}.lst-kix_zf9przpwvhgy-0>li{counter-increment:lst-ctn-kix_zf9przpwvhgy-0}li.li-bullet-0:before{margin-left:-18pt;white-space:nowrap;display:inline-block;min-width:18pt}ol.lst-kix_kgugg8j2ftt9-2.start{counter-reset:lst-ctn-kix_kgugg8j2ftt9-2 0}.lst-kix_zf9przpwvhgy-6>li{counter-increment:lst-ctn-kix_zf9przpwvhgy-6}ol.lst-kix_zf9przpwvhgy-4.start{counter-reset:lst-ctn-kix_zf9przpwvhgy-4 0}ol{margin:0;padding:0}table td,table th{padding:0}.c50{padding-top:16pt;padding-bottom:8pt;line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left;height:14pt}.c20{margin-left:17pt;padding-top:0pt;padding-bottom:0pt;line-height:1.5;orphans:2;widows:2;text-align:left;margin-right:4pt}.c36{padding-top:16pt;padding-bottom:4pt;line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left;height:14pt}.c31{padding-top:14pt;padding-bottom:4pt;line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c19{padding-top:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.5;orphans:2;widows:2;text-align:left}.c65{padding-top:16pt;padding-bottom:4pt;line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c74{padding-top:12pt;padding-bottom:4pt;line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c1{padding-top:0pt;padding-bottom:0pt;line-height:1.5;orphans:2;widows:2;text-align:left;height:11pt}.c61{padding-top:16pt;padding-bottom:8pt;line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c13{padding-top:0pt;text-indent:36pt;padding-bottom:0pt;line-height:1.5;orphans:2;widows:2;text-align:left}.c29{padding-top:12pt;padding-bottom:8pt;line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c43{background-color:#ffffff;padding-top:0pt;padding-bottom:8pt;line-height:1.5;orphans:2;widows:2;text-align:center}.c15{background-color:#1f1f1f;padding-top:0pt;padding-bottom:0pt;line-height:1.5;orphans:2;widows:2;text-align:left}.c58{padding-top:14pt;padding-bottom:8pt;line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c0{padding-top:0pt;text-indent:36pt;padding-bottom:0pt;line-height:1.5;orphans:2;widows:2;text-align:center}.c52{padding-top:0pt;padding-bottom:0pt;line-height:1.6363636363636365;orphans:2;widows:2;text-align:justify}.c64{padding-top:0pt;padding-bottom:0pt;line-height:1.35;orphans:2;widows:2;text-align:left}.c62{padding-top:12pt;padding-bottom:0pt;line-height:1.5;orphans:2;widows:2;text-align:center}.c47{padding-top:0pt;padding-bottom:8pt;line-height:1.5;orphans:2;widows:2;text-align:left}.c7{padding-top:0pt;padding-bottom:0pt;line-height:1.5;orphans:2;widows:2;text-align:center}.c39{padding-top:0pt;padding-bottom:0pt;line-height:1.5;orphans:2;widows:2;text-align:left}.c57{padding-top:2pt;padding-bottom:0pt;line-height:1.5;orphans:2;widows:2;text-align:left}.c9{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c28{padding-top:10pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:center}.c46{padding-top:0pt;padding-bottom:0pt;line-height:1.0;orphans:2;widows:2;text-align:left}.c49{color:#434343;font-weight:400;font-size:14pt;font-family:"Arial"}.c3{color:#000000;text-decoration:none;vertical-align:baseline;font-style:normal}.c22{font-size:9pt;font-family:"Courier New";color:#ce9178;font-weight:400}.c77{-webkit-text-decoration-skip:none;text-decoration:underline;text-decoration-skip-ink:none;font-size:20pt}.c60{font-size:9pt;font-family:"Courier New";color:#c586c0;font-weight:400}.c53{font-size:9pt;font-family:"Courier New";color:#b5cea8;font-weight:400}.c4{font-size:9pt;font-family:"Courier New";color:#cccccc;font-weight:400}.c23{font-size:9pt;font-family:"Courier New";color:#dcdcaa;font-weight:400}.c69{padding-top:0pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c17{-webkit-text-decoration-skip:none;color:#1155cc;text-decoration:underline;text-decoration-skip-ink:none}.c66{color:#6a9955;font-weight:400;font-size:9pt;font-family:"Courier New"}.c63{color:#666666;font-weight:400;font-size:13pt;font-family:"Times New Roman"}.c11{color:#9cdcfe;font-weight:400;font-size:9pt;font-family:"Courier New"}.c6{color:#0e00ff;text-decoration:none;vertical-align:baseline;font-style:normal}.c10{font-size:9pt;font-family:"Courier New";color:#d4d4d4;font-weight:400}.c24{font-size:9pt;font-family:"Courier New";color:#4ec9b0;font-weight:400}.c40{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c56{font-weight:400;font-size:16pt;font-family:"Times New Roman"}.c2{font-size:12pt;font-family:"Times New Roman";font-weight:400}.c37{font-weight:700;font-size:12pt;font-family:"Times New Roman"}.c59{font-weight:400;font-size:11pt;font-family:"Times New Roman"}.c27{font-weight:700;font-size:13pt;font-family:"Times New Roman"}.c38{font-weight:700;font-size:14pt;font-family:"Times New Roman"}.c48{font-weight:400;font-size:4pt;font-family:"Times New Roman"}.c5{font-weight:400;font-size:10pt;font-family:"Courier New"}.c21{font-weight:400;font-size:11pt;font-family:"Arial"}.c55{font-weight:400;font-size:14pt;font-family:"Times New Roman"}.c45{font-weight:400;font-size:10.5pt;font-family:"Arial"}.c25{font-weight:700;font-size:11pt;font-family:"Arial"}.c8{text-decoration:none;vertical-align:baseline;font-style:normal}.c70{font-family:"Times New Roman";font-weight:700}.c34{padding:0;margin:0}.c72{font-family:"Times New Roman";font-weight:400}.c44{border:1px solid black;margin:5px}.c26{vertical-align:baseline;font-style:normal}.c42{color:inherit;text-decoration:inherit}.c16{color:#212121}.c68{color:#666666}.c32{color:#0e00ff}.c75{font-size:11pt}.c14{margin-left:36pt}.c33{background-color:#1f1f1f}.c30{color:#000000}.c67{vertical-align:super}.c51{background-color:#ffffff}.c18{text-indent:36pt}.c12{height:11pt}.c41{margin-right:4pt}.c71{margin-left:17pt}.c54{vertical-align:sub}.c35{font-style:italic}.c76{height:12pt}.c73{color:#a709f5}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c40 doc-content"><p class="c7"><span class="c72 c77">ECE3750 Project Final Report</span></p><h1 class="c62" id="h.rxvafmqs24i"><span class="c3 c55">Phased and Confused</span></h1><h1 class="c62" id="h.bm1pdjx0gc1b"><span class="c3 c55">December 8th, 2023</span></h1><p class="c47"><span class="c3 c2">&nbsp;</span></p><h2 class="c57" id="h.dfrp98legjc5"><span class="c3 c2">Team Member 1: Quentin Olsen</span></h2><h2 class="c57" id="h.brbqi4vo3ie1"><span class="c3 c2">Team Member 2: Bhargav Moosani</span></h2><h2 class="c57" id="h.qxtetn47fg2m"><span class="c3 c2">Team Member 3: Maxim Titov</span></h2><p class="c9 c12"><span class="c3 c21"></span></p><h2 class="c57" id="h.jsh7uo6k8jjs"><span class="c2">Pledge: </span><span class="c2">On my honor, I </span><span class="c2">pledge</span><span class="c2">&nbsp;that I have neither given nor received help on this assignment</span></h2><p class="c47"><span class="c3 c2">&nbsp;</span></p><p class="c47"><span class="c3 c38">Team Member Responsibilities:</span></p><p class="c47"><span class="c3 c2">Bhargav Moosani: </span></p><p class="c47"><span class="c3 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The filters were designed, verified, and tested by me. I firstly wrote code to come up with resistor and capacitor values that would produce the correct corner frequency for our filters. I then simulated these numerically and prepared their experimental testing. This was done by figuring out pins at the input and output of the filter system that would be used to run an AC sweep. </span></p><p class="c47"><span class="c3 c2">Quentin Olsen: </span></p><p class="c47"><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Handled the design and experimental testing of the In-Amp and isolator. Design and layout of the PCB. Test plan was worked on equally by every member. Experimental testing </span><span class="c2">on subject</span><span class="c3 c2">&nbsp;was done together. Typed the parts list for 3W. Soldered DNI part. Steps 1 and 2 of board testing (connectivity and power).</span></p><p class="c47"><span class="c3 c2">Max Titov:</span></p><p class="c47"><span class="c3 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Designed the input high pass filter for the In-Amp. Ran transient simulations in Multisim for the input, In-Amp, filter, and isolator. Ran AC sweeps for both stages of the filter. Helped with testing the power supply. Wrote the code for the FIR filter.</span></p><h3 class="c50" id="h.u9m5dshhym38"><span class="c3 c38"></span></h3><h3 class="c61" id="h.lq86i9dfykrh"><span class="c3 c38">Section 1</span></h3><h4 class="c58" id="h.xfw6otaiy0ib"><span class="c3 c27">a. Background</span></h4><h5 class="c29" id="h.a0pu40k4f5om"><span class="c3 c37">i. Explanation of Design Approach</span></h5><p class="c9 c12"><span class="c3 c21"></span></p><p class="c13"><span class="c3 c2">The ultimate goal of this project is to build a functional electrocardiogram (EKG), a device that records the electrical signal of the heart and its pulses to identify its condition. Our device can be described in 4 stages and 5 different subsystems. See the diagram below:</span></p><p class="c1 c18"><span class="c3 c2"></span></p><p class="c1"><span class="c3 c2"></span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 594.74px; height: 125.42px;"><img alt="" src="images/image64.png" style="width: 594.74px; height: 133.12px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c3 c2"></span></p><p class="c1"><span class="c3 c2"></span></p><p class="c13"><span class="c3 c2">The electrical pulses will be taken from a subject&rsquo;s wrist and inputted into an in-amp and integrator system. This will output the difference of both inputs and remove common noise. The differential signal will then be passed through a filter to remove high frequencies, essentially &ldquo;cleaning up&rdquo; the signal, making it visually cleaner. The filtered signal is then passed through the isolator. The isolator shouldn&rsquo;t transform or change the signal, but protects the device&rsquo;s power system in case of a short or other electrical failure. Finally, the output will undergo a digital signal process to produce a clean and readable output. The final system power&rsquo;s all other electrical subsystems. It is not a stage in the production of a readable heart pulse, but it is the backbone of the system. The power system integrates two different sources of power: a 9V battery and the Analog Discovery 2 DC power supply.</span></p><p class="c1"><span class="c3 c2"></span></p><p class="c1"><span class="c3 c2"></span></p><h5 class="c29" id="h.c8a3lv6omad"><span class="c3 c37">ii. Expected Signal levels and required gain</span></h5><p class="c9 c12"><span class="c3 c21"></span></p><p class="c13"><span class="c3 c2">An electrode is an electrical conductor used to read electrical signals on non metallic surfaces. In this project, we use electrodes on both wrists and the ankle to pick up electrical signals from the heart&rsquo;s conduction system. This will usually produce signals in the 1 mV peak to peak range. This presents the first difficulty in this project. 1 mV peak to peak range signals are often lost in the noise of the surrounding environment. The In-Amp and the filter work to reduce the noise, but there is only so much that can be done. </span></p><p class="c1"><span class="c3 c2"></span></p><p class="c13"><span class="c3 c2">The goal is to have an output pulse signal in the 1V to 2.5V peak to peak range, as per the project calculation requirements.</span></p><p class="c1"><span class="c3 c2"></span></p><p class="c13"><span class="c3 c2">This requires a total gain of 1000 to 2500. This gain will be mainly achieved with the In-Amp. The In-Amp has a gain resistor, and is capable of producing an output signal 1000 times the amplitude of the input.</span></p><p class="c1"><span class="c3 c2"></span></p><h5 class="c29" id="h.we0bxhrjx81a"><span class="c3 c37">iii. Explain Filter requirements</span></h5><p class="c9 c12"><span class="c3 c21"></span></p><p class="c13"><span class="c3 c2">Our antialias filter was required to be a 4th order Butterworth with -72dB attenuation at 500Hz. This was used to find an analytical corner frequency of the filter to be 63 Hz. This is a low-pass filter; frequencies above 63 Hz will be attenuated. The filter was also expected to have a gain of 1. Finally, it was asked that the input resistance of the filter be greater than 10k&Omega;. </span></p><p class="c1"><span class="c3 c2"></span></p><p class="c13"><span class="c3 c2">A Butterworth filter, by definition, has -3dB at the corner frequency, a Q value of 0.707. For a 4th order butterworth designed as a cascade of two filters with Sallen-Key architecture, this often is achieved with a low Q value on the first filter, and a higher Q value on the second. This rejects the chance for the first filter to try to produce a signal with an amplitude larger than its power supply. Ultimately, the first filter was set with a Q = 0.5412 and the second with Q = 1.3065.</span></p><h4 class="c58" id="h.w1szhlq7s1jr"><span class="c27 c30">b. Schematics</span></h4><h5 class="c29" id="h.84twgtudtapr"><span class="c3 c70 c75">i. Power Supply</span></h5><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 1.33px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 363.20px; height: 268.64px;"><img alt="" src="images/image48.png" style="width: 363.20px; height: 268.64px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c7"><span class="c3 c2">Figure 1. Abstracted circuit schematic</span></p><p class="c1"><span class="c3 c2"></span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 1.33px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 416.00px; height: 263.28px;"><img alt="" src="images/image60.png" style="width: 416.00px; height: 263.28px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c7"><span class="c3 c2">Figure 2. Lower Level Circuit </span></p><p class="c7"><span class="c3 c2">Schematic</span></p><p class="c7 c12"><span class="c3 c2"></span></p><p class="c13"><span class="c3 c2">The point of the power supply is to set VCC, for which most IC&rsquo;s on the board will use, to 3.3V. This is implemented with two different sources. The first is done by stepping down a 9V voltage from an auxiliary battery, using a voltage regulator (U6). The second from the Analog Discovery 2&rsquo;s DC voltage supply. This directly puts out 3.3V. </span></p><p class="c1"><span class="c3 c2"></span></p><p class="c13"><span class="c3 c2">Header pins are installed to simplify testing. We&rsquo;ll want to test the board with 3.3V from the Analog Discovery 2 before running it with a high 9V supply from the battery. The 2x1 header J99 connects the grounds of both sources. When the battery is not being used, we&rsquo;ll still want its ground node to be tied to 0V. J99 ties the unconnected battery ground to the Analog Discovery 2&rsquo;s ground. The 3x1 header J5 allows us to choose the source of VCC. When shunting the top and middle pins of J5 the battery power supply is rendered obsolete, and the system can run on the Analog Discovery 2 power source alone.</span></p><h5 class="c29" id="h.6o9fo8snhrqe"><span class="c3 c37">ii. Instrumentation Amplifier </span></h5><p class="c9 c12"><span class="c3 c21"></span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: -0.00px 0.00px; border: 1.33px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 459.75px; height: 237.86px;"><img alt="" src="images/image42.png" style="width: 459.75px; height: 237.86px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c7"><span class="c3 c2">Figure 3. In-Amp Schematic</span></p><p class="c7 c12"><span class="c3 c2"></span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 1.33px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 347.10px; height: 273.50px;"><img alt="" src="images/image63.png" style="width: 347.10px; height: 273.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c7"><span class="c3 c2">Figure 4. VMid Production System</span></p><p class="c7 c12"><span class="c3 c2"></span></p><p class="c13"><span class="c3 c2">The in-amp has two parts to it. Figure 3 consists of the left and right inputs that are fed through a high pass filter before the in-amp. Additionally, the output of the in-amp has an integrator to get rid of voltage offset from the in-amp. Figure 4 shows a voltage divider with an op amp in unity gain and the gain resistor. </span></p><p class="c1"><span class="c3 c2"></span></p><p class="c39"><span class="c3 c2">The high pass filter at the input of the In-Amp has two requirements:</span></p><ul class="c34 lst-kix_tlbproir1c2j-0 start"><li class="c19 c14 li-bullet-0"><span class="c2">250K </span><img src="images/image1.png"><span class="c2">&nbsp;DC Resistance to VMid </span><img src="images/image1.png"><span class="c3 c2">&nbsp;300K </span></li><li class="c19 c14 li-bullet-0"><span class="c2">3dB Breakpoint (per input filter) at 0.05Hz </span><img src="images/image1.png"><span class="c2">&nbsp;F3db </span><img src="images/image1.png"><span class="c3 c2">&nbsp;0.1 Hz. </span></li></ul><p class="c39"><span class="c2">We chose a R2 and R3 value of 270k&Omega;. Then we converted the breakpoint values to rad/s: 0.314 rad/s </span><img src="images/image1.png"><span class="c2">&nbsp;F3db </span><img src="images/image1.png"><span class="c3 c2">&nbsp;0.628 rad/s. Then we calculated the capacitor value as shown below:</span></p><p class="c1 c18"><span class="c3 c2"></span></p><p class="c7"><img src="images/image2.png"></p><p class="c7"><img src="images/image3.png"></p><p class="c7"><img src="images/image4.png"></p><p class="c7 c12"><span class="c3 c2"></span></p><p class="c13"><span class="c3 c2">Trying a value of 10uF for C:</span></p><p class="c1 c18"><span class="c3 c2"></span></p><p class="c7"><img src="images/image5.png"></p><p class="c7 c12"><span class="c3 c2"></span></p><p class="c13"><span class="c3 c2">This matches the provided specification.</span></p><p class="c1"><span class="c3 c2"></span></p><p class="c13"><span class="c3 c2">Next, we calculated the value of our gain resistor. We know that the gain of our AD623 in-amp is: </span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 162.30px; height: 73.91px;"><img alt="" src="images/image69.png" style="width: 162.30px; height: 73.91px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c7 c12"><span class="c3 c21"></span></p><p class="c13"><span class="c2">Looking through the given </span><span class="c2">EKG</span><span class="c2">&nbsp;values, we see that they are in the 1mV range. The specification for the in-amp was that the output of it should be in the 1.0 to 2.5V range. Looking at the datasheet for the AD623 </span><span class="c2">(Reference [1])</span><span class="c3 c2">, we can see that the maximum gain is 1000, which is precisely the value we need to go from 1mV to 1V to match the specification. Knowing this, we can calculate the value of the gain resistor R:</span></p><p class="c7"><img src="images/image6.png"></p><p class="c7"><img src="images/image7.png"></p><h5 class="c29" id="h.zba3pohuwnxk"><span class="c3 c37">iii. Filter </span></h5><p class="c9 c12"><span class="c3 c21"></span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: -0.00px 0.00px; border: 1.33px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 436.00px; height: 206.53px;"><img alt="" src="images/image62.png" style="width: 436.00px; height: 206.53px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c7"><span class="c3 c2">Figure 5. Abstracted Circuit Schematic</span></p><p class="c7 c12"><span class="c3 c2"></span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: -0.00px -0.00px; border: 1.33px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 559.00px; height: 183.90px;"><img alt="" src="images/image57.png" style="width: 559.00px; height: 183.90px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c7"><span class="c3 c2">Figure 6. Lower Level Circuit Schematic</span></p><p class="c7 c12"><span class="c3 c2"></span></p><p class="c13"><span class="c2">The anti-aliasing filter seen above is a 4</span><span class="c2 c67">th</span><span class="c2">&nbsp;order Butterworth filter, which is used to attenuate high frequency signals and prevent as much rippling as possible in the pass-band. The filter is made up of two cascaded 2</span><span class="c2 c67">nd</span><span class="c2">&nbsp;order low-pass filters. Since our filter&rsquo;s total response is 4</span><span class="c2 c67">th</span><span class="c3 c2">&nbsp;order low-pass, we&rsquo;ll have a -80dB/dec roll-off in our frequency response at the corner frequency. </span></p><p class="c1"><span class="c3 c2"></span></p><p class="c13"><span class="c3 c2">Given a specification of -72dB attenuation at 500Hz, we were able to find our desired corner frequency as such:</span></p><p class="c7"><img src="images/image8.png"></p><p class="c7"><img src="images/image9.png"></p><p class="c7 c12"><span class="c3 c2"></span></p><p class="c13"><span class="c2">Since we are looking for a gain of 1, we can use the following simplification methods which adhere to the Sallen-Key design of this filter </span><span class="c2">(Reference [2])</span></p><p class="c1 c18"><span class="c3 c2"></span></p><p class="c7"><img src="images/image10.png"><span class="c2">, </span><img src="images/image11.png"></p><p class="c7"><img src="images/image12.png"></p><p class="c7"><img src="images/image13.png"></p><p class="c7 c12"><span class="c3 c2"></span></p><p class="c13"><span class="c2">For each 2</span><span class="c2 c67">nd</span><span class="c2">&nbsp;order segment, we&rsquo;ll want Q values of 0.5412 for the first filter (</span><span class="c2 c35">Q</span><span class="c2 c54 c35">1</span><span class="c2">)</span><span class="c2">&nbsp;and 0.13065 for the second filter (</span><span class="c2 c35">Q</span><span class="c2 c54 c35">2</span><span class="c2">). This will allow for a total Q of 0.707, which is ideal for our 4</span><span class="c2 c67">th</span><span class="c2">&nbsp;order Butterworth response. Using the code shown in </span><span class="c2">Appendix </span><span class="c3 c2">A and the equations above, we sifted through the component values kit values to match the desired Q values as close as possible while having an input resistance greater than 10k&Omega; for both filters, which generated the following results:</span></p><p class="c1 c18"><span class="c3 c2"></span></p><p class="c7"><img src="images/image14.png"><span class="c2">, </span><img src="images/image15.png"></p><p class="c7"><img src="images/image16.png"><span class="c2">, </span><img src="images/image17.png"></p><p class="c7"><img src="images/image18.png"></p><p class="c7"><img src="images/image19.png"></p><p class="c7 c12"><span class="c3 c2"></span></p><p class="c47 c18"><span class="c2">Since our filters are unity gain, the input resistance is equal to </span><span class="c2 c35">R</span><span class="c2 c54 c35">8</span><span class="c2">&nbsp;and </span><span class="c2 c35">R</span><span class="c2 c54 c35">10</span><span class="c2">&nbsp;for its respective filter; our values fit the input resistance specification of greater than 10k&Omega;. </span><span class="c2">Also, </span><span class="c2 c35">C</span><span class="c2 c54 c35">14</span><span class="c2 c35">&nbsp;</span><span class="c3 c2">is a bypass capacitor so its value is 0.1uF, which was constant for all bypass capacitors on our project board. </span></p><p class="c13"><span class="c2">With the chosen component values, we produced </span><span class="c2 c35">Q</span><span class="c2 c35 c54">1</span><span class="c2">&nbsp;= 0.5 and </span><span class="c2 c35">Q</span><span class="c2 c54 c35">2</span><span class="c3 c2">&nbsp;= 0.1.348, giving us a total Q of 0.674, which falls within 1.5dB of a Butterworth response:</span></p><p class="c1 c18"><span class="c3 c2"></span></p><p class="c7"><img src="images/image20.png"><span class="c2">&nbsp;&lt; Q &lt; </span><img src="images/image21.png"></p><p class="c7"><span class="c3 c2">0.6 &lt; 0.674 &lt; 0.84</span></p><p class="c7 c12"><span class="c3 c2"></span></p><h5 class="c29" id="h.rv4qt0r9l7no"><span class="c37 c30">iv</span><span class="c3 c37">. Isolator </span></h5><p class="c9 c12"><span class="c3 c21"></span></p><p class="c13"><span class="c3 c2">The isolator is used to protect the device and patient in case of device failure. It separates both power sources as shown in the higher level circuit schematic. </span></p><p class="c39"><span class="c3 c2">&nbsp;</span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 1.33px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 431.50px; height: 267.67px;"><img alt="" src="images/image41.png" style="width: 431.50px; height: 267.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c7"><span class="c3 c59">Figure 7. Abstracted Circuit Schematic</span></p><p class="c7 c12"><span class="c3 c59"></span></p><p class="c1"><span class="c3 c59"></span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 1.33px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 500.30px; height: 264.58px;"><img alt="" src="images/image65.png" style="width: 500.30px; height: 264.58px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c7"><span class="c3 c2">Figure 8. Lower Level Circuit Schematic</span></p><p class="c1"><span class="c3 c2"></span></p><p class="c13"><span class="c2">The U15 isolator chip can be understood as transfering the signal onto a different power source using photodiodes. The main design of the isolator was in determining the gain of the system, which should be equal to 1. In other words, the input should be equal to the output. The isolator system is designed as a unipolar isolation amplifier. Looking at the isolator datasheet (</span><span class="c2">Reference [3])</span><span class="c3 c2">, we find the gain to be:</span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 199.30px; height: 57.58px;"><img alt="" src="images/image58.png" style="width: 199.30px; height: 57.58px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c7 c12"><span class="c3 c2"></span></p><p class="c13"><span class="c3 c2">Where R2 and R3 are the resistors shown in the figure below.</span></p><p class="c1 c18"><span class="c3 c2"></span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 518.68px; height: 183.25px;"><img alt="" src="images/image54.png" style="width: 518.68px; height: 208.34px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c7"><span class="c3 c2">Figure 9. Unipolar Photoconductive Isolation</span></p><p class="c7"><span class="c3 c2">Amplifier</span></p><p class="c1"><span class="c3 c2"></span></p><p class="c13"><span class="c3 c2">K3 is the transfer gain, and because K3 is the ratio of K1 (Servo Gain) and K2 (Output Forward Gain), it is extremely temperature dependent and can vary greatly between parts.</span></p><p class="c39"><span class="c3 c2">Our isolator chips were found to be in Bin H, which means K3 was between 1.297 to 1.456.</span></p><p class="c1"><span class="c3 c2"></span></p><p class="c13"><span class="c3 c2">We are looking for a gain of 1. This gives:</span></p><p class="c1 c18"><span class="c3 c2"></span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 168.30px; height: 84.56px;"><img alt="" src="images/image39.png" style="width: 168.30px; height: 84.56px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c3 c2">&nbsp;</span></p><p class="c7 c12"><span class="c3 c2"></span></p><p class="c13"><span class="c3 c2">R2 = 56k&Omega; and R1 = 82k&Omega; satisfies this. </span></p><p class="c39"><span class="c3 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p class="c13"><span class="c3 c2">R1, which is R12 on our board, was left uninstalled when testing. This allowed us to test a resistor and the isolator&rsquo;s gain before soldering it in. </span></p><p class="c1"><span class="c3 c2"></span></p><p class="c13"><span class="c3 c2">It was also necessary to determine the current going through R13 and into the isolator&rsquo;s LED. We were asked to produce a 0.5 voltage drop over R13. The current is set by K1, R1, and Vin. </span></p><p class="c1 c18"><span class="c3 c2"></span></p><p class="c13"><span class="c3 c2">With Vin about 1V, R1 = 82k&Omega;, and K1 to be 0.012, we can calculate Io. &nbsp;</span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 106.82px; height: 58.11px;"><img alt="" src="images/image46.png" style="width: 106.82px; height: 58.11px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c13"><span class="c3 c2">This was actually used to calculate R1 first, but for practical purposes, we&rsquo;ll show that the R1 satisfies what we want for Io. </span></p><p class="c1 c18"><span class="c3 c2"></span></p><p class="c13"><span class="c2">Also, it is important to note the maximum output current from the Op-Amp (</span><span class="c2">Reference [4]</span><span class="c3 c2">) which was found to be 30 mA. Given R1, K1, and Vin, we&rsquo;ll consider that this maximum won&rsquo;t be reached. Io was found to be 5 mA. Using Ohm&rsquo;s law, we choose R13 = 100&Omega;, which gives a voltage drop across R13 of 0.5V.</span></p><h4 class="c31" id="h.gtws2lli1854"><span class="c3 c27">c. Multisim Simulations</span></h4><h5 class="c29" id="h.gqctftallatp"><span class="c3 c37">i. Time Domain Plots With EKG Data</span></h5><p class="c9 c12"><span class="c3 c21"></span></p><p class="c13"><span class="c3 c2">We ran transients with the provided EKG data at several points throughout the circuit.</span></p><p class="c1 c18"><span class="c3 c2"></span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 500.86px; height: 294.44px;"><img alt="" src="images/image68.png" style="width: 507.59px; height: 294.44px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c7"><span class="c3 c2">Figure 10: Difference Between the Left and Right Inputs</span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 466.12px; height: 248.50px;"><img alt="" src="images/image51.png" style="width: 466.12px; height: 248.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c7"><span class="c3 c2">Figure 11: Output of the In-Amp</span></p><p class="c7 c12"><span class="c3 c2"></span></p><p class="c1"><span class="c3 c2"></span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 452.00px; height: 307.32px;"><img alt="" src="images/image67.png" style="width: 452.00px; height: 307.32px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c7"><span class="c3 c2">Figure 12: Output of the Filter (red) and Isolator (green)</span></p><p class="c7 c12"><span class="c3 c2"></span></p><p class="c7 c12"><span class="c3 c2"></span></p><p class="c13"><span class="c3 c2">Figure 10 shows the difference between the left and right inputs of the simulation. This is essentially what the in-amp does, so this is a good way to see the amplification of the in-amp. We can see that the data is in the range of 1mV. Looking at Figure 11, we notice that the output of the in-amp looks the same as Figure 10, except that the signal is amplified to a range of 1V to 2V, which matches the specification of 1V to 2.5V. Next, Figure 12 shows the signal after passing through the low pass antialias filter and after the isolator. The filter smooths out the data by attenuating higher frequencies to make it more readable. The isolator was designed to have a gain of 1, and Figure 12 shows that the two signals are very close in amplitude.</span></p><p class="c1 c18"><span class="c3 c2"></span></p><h5 class="c29" id="h.7oe47bqhc2w"><span class="c37 c30">ii. Frequency Domain Plots</span><span class="c2 c8 c68">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></h5><p class="c9"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p class="c13"><span class="c3 c2">We ran AC Sweeps on the anti-alias filter in three steps. First the first filter, with Q of 0.5412, we expect to see -5.3 dB at the corner frequency of 63Hz.</span></p><p class="c1"><span class="c3 c2"></span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 417.00px; height: 282.48px;"><img alt="" src="images/image37.png" style="width: 417.00px; height: 282.48px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c7"><span class="c3 c2">Figure 13: First Filter Bode Plot</span></p><p class="c7 c12"><span class="c3 c2"></span></p><p class="c13"><span class="c3 c2">Looking at Figure 13, we can see that we have a breakpoint frequency of about 60Hz, which matches the analytical value of 63Hz.</span></p><p class="c1 c18"><span class="c3 c2"></span></p><p class="c13"><span class="c3 c2">First the second filter, with Q of 1.3065, we expect to see 2.3 dB at the corner frequency of 63Hz.</span></p><p class="c1 c18"><span class="c3 c2"></span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 447.00px; height: 305.73px;"><img alt="" src="images/image36.png" style="width: 447.00px; height: 305.73px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c7"><span class="c3 c2">Figure 14: Second Filter Bode Plot</span></p><p class="c7 c12"><span class="c3 c2"></span></p><p class="c13"><span class="c3 c2">Looking at Figure 14, we can see that we have a breakpoint frequency of about 60Hz, which matches the analytical value of 63Hz.</span></p><p class="c1"><span class="c3 c2"></span></p><p class="c13"><span class="c3 c2">Finally, the total system is 4th order butterworth, so we expect -3dB at the corner frequency.</span></p><p class="c1 c18"><span class="c3 c2"></span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 453.50px; height: 309.86px;"><img alt="" src="images/image40.png" style="width: 453.50px; height: 309.86px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c7"><span class="c3 c2">Figure 15: Second Filter Bode Plot</span></p><p class="c7 c12"><span class="c3 c2"></span></p><p class="c13"><span class="c3 c2">Looking at Figure 15, we can see that we have a breakpoint frequency of about 60Hz, which matches the analytical value of 63Hz.</span></p><p class="c1"><span class="c3 c2"></span></p><p class="c39"><span class="c3 c27">d. Layout</span></p><h5 class="c29" id="h.f720gquuvlht"><span class="c3 c37">i. Overlay of Board</span></h5><p class="c9 c12"><span class="c3 c21"></span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 1.33px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 323.28px; height: 424.24px;"><img alt="" src="images/image47.png" style="width: 323.28px; height: 424.24px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c7"><span class="c3 c2">Figure 16. Copper Bottom (Red), Copper Top (Green),</span></p><p class="c7"><span class="c3 c2">&nbsp;Silkscreen (blue)</span></p><p class="c7 c12"><span class="c3 c2"></span></p><h5 class="c29" id="h.urnhnwcl76tg"><span class="c3 c37">ii. Component Placement</span></h5><p class="c9 c12"><span class="c3 c21"></span></p><p class="c13"><span class="c2">The main placement choice for the board was to line up the IC chips, with bypass capacitors in between. This allows us to have straight and long power wiring along the length of the board. R12, our DNI part, was placed on the edge for ease of placement and soldering. Generally, horizontal traces were made on the bottom side, and vertical traces, which were more frequent, were made on the top side. The IC chips follow a loop that parallels the stages of our EKG. First the In-Amp and EKG, then the filter, then the first op-amp of the isolator circuit, then the isolator, and finally the second op-amp after the isolator. </span></p><h5 class="c74" id="h.irgsukrp2coh"><span class="c3 c37">iii. Gerber File Generation and FreeDFM submission</span></h5><p class="c9 c12"><span class="c3 c21"></span></p><p class="c13"><span class="c3 c2">To check the validity of our board, it had to be sent to FreeDFM as a zip containing gerber files. A general outline (Reference [5]) was followed to do this. First a DRC and connectivity check was run within Ultiboard. The files were then exported as gerber files using the UVA CAM export structure. Using CAM File Renamer software, the files were renamed and downloaded as a zip. This was submitted to FreeDFM, which confirmed its integrity. There were no issues encountered during this process. </span></p><h3 class="c65" id="h.t6yq6tgozo26"><span class="c3 c38">Section 2</span></h3><h4 class="c58" id="h.qtpy317h4ltk"><span class="c3 c27">a. Assembly and Testing</span></h4><p class="c13"><span class="c3 c2">The board was tested in the following steps:</span></p><p class="c1"><span class="c3 c2"></span></p><ol class="c34 lst-kix_zf9przpwvhgy-0 start" start="1"><li class="c19 c14 li-bullet-0"><span class="c3 c2">Connectivity tests. Our multimeter was set to beep if two metal contacts share a node. We tested every node from its furthest connections. No issues were found.</span></li><li class="c19 c14 li-bullet-0"><span class="c3 c2">Next, voltage was input to the board. VCC, ground, and VMID were measured with a multimeter for every op-amp before putting the IC&rsquo;s in. </span></li><li class="c19 c14 li-bullet-0"><span class="c3 c2">Once the power was verified for usability (this was not a full verification of the power system, because it was not done with the battery and testing of the regulator) we could test each subsystem, beginning with the In-Amp. A small 1mv sin wave was input on one input to the In-Amp, tying the other to ground. The expected output was a 1V (gain of 1000) sine wave with 1.65 offset. Below is an experimental graph of the In-Amps output.</span></li></ol><p class="c1"><span class="c3 c2"></span></p><p class="c43"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 418.00px; height: 259.37px;"><img alt="" src="images/image53.png" style="width: 418.00px; height: 259.37px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c43"><span class="c2 c8 c16">Figure 17. In-Amp Output </span></p><p class="c43 c12"><span class="c2 c8 c16"></span></p><p class="c47 c14 c51"><span class="c2 c8 c16">This confirms both the functionality of the In-Amp and the integrator. The sin wave at the input has a varying amplitude, but this is only due to the AD2&rsquo;s difficulty of putting out such a small AC voltage accurately. </span></p><p class="c47 c14 c51 c12"><span class="c2 c8 c16"></span></p><ol class="c34 lst-kix_zf9przpwvhgy-0" start="4"><li class="c19 c14 li-bullet-0"><span class="c3 c2">Next, we&rsquo;d test the filter in three steps. First the first filter, with Q of 0.5412. At the corner frequency of 63Hz, we should see -5.3 dB.</span></li></ol><p class="c1 c14"><span class="c3 c2"></span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: -0.00px -0.00px; border: 1.33px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 536.90px; height: 205.25px;"><img alt="" src="images/image56.png" style="width: 536.90px; height: 205.25px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c7"><span class="c3 c2">Figure 18. Filter Section 1 Bode Plot</span></p><p class="c7 c12"><span class="c3 c2"></span></p><p class="c39 c14"><span class="c3 c2">This confirms the first filter.</span></p><p class="c39"><span class="c3 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p class="c39 c14"><span class="c3 c2">The second filter has a Q of 1.3065. At the corner frequency, we should see 2.3 dB.</span></p><p class="c1"><span class="c3 c2"></span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: -0.00px -0.00px; border: 1.33px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 540.87px; height: 189.72px;"><img alt="" src="images/image44.png" style="width: 657.43px; height: 189.72px; margin-left: -0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c7"><span class="c2">Figure 19. Filter Section 2 Bode Plot</span></p><p class="c39"><span class="c3 c25">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p class="c39 c14"><span class="c3 c2">We&rsquo;ll notice that we see 2.3 dB at a low corner frequency, but the overall system isn&rsquo;t affected too greatly.</span></p><p class="c1"><span class="c3 c2"></span></p><p class="c39 c14"><span class="c3 c2">Finally, the total system is 4th order butterworth, so we expect -3dB at the corner frequency.</span></p><p class="c1"><span class="c3 c2"></span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: -0.00px -0.00px; border: 1.33px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 553.14px; height: 158.71px;"><img alt="" src="images/image59.png" style="width: 553.14px; height: 158.71px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c7"><span class="c3 c2">Figure 20. Full Filter Bode Plot</span></p><p class="c7 c12"><span class="c3 c2"></span></p><ol class="c34 lst-kix_zf9przpwvhgy-0" start="5"><li class="c14 c19 li-bullet-0"><span class="c3 c2">Finally, we were to test the isolator. The main task was to confirm the gain of the system. With a 1V, 60Hz input signal, the isolator outputted something very similar to the input, as seen below. </span></li></ol><p class="c1"><span class="c3 c2"></span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 1.33px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 440.00px; height: 259.56px;"><img alt="" src="images/image55.png" style="width: 440.00px; height: 259.56px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c7"><span class="c2">Figure 21. Isolator Output vs. Input</span></p><p class="c7 c12"><span class="c3 c21"></span></p><p class="c39 c14"><span class="c3 c2">The isolator was deduced to be functional. This was repeated at the output of the unity gain buffer that succeeds the isolator, and the signal was the same, which confirmed that op-amps functionality. </span></p><p class="c1 c14"><span class="c3 c2"></span></p><ol class="c34 lst-kix_zf9przpwvhgy-0" start="6"><li class="c19 c14 li-bullet-0"><span class="c3 c2">We could now test the full system with the downloaded EKG data at the input of the In-Amp. The other input of the In-Amp was tied to ground. The output was taken at the output of U4, the unity gain buffer at the output. The following graph shows the output.</span></li></ol><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 546.43px; height: 352.50px;"><img alt="" src="images/image43.png" style="width: 550.72px; height: 352.50px; margin-left: -4.30px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c7"><span class="c3 c2">Figure 22. EKG Output 3</span></p><p class="c7 c12"><span class="c3 c2"></span></p><ol class="c34 lst-kix_zf9przpwvhgy-0" start="7"><li class="c19 c14 li-bullet-0"><span class="c3 c2">Once the functionality of the whole system was confirmed, we&rsquo;d be able to test on a human subject. First, however, we wanted to make sure the device could run on the battery supply. The IC&rsquo;s were removed. The battery was plugged in, and the output of the regulator was confirmed to be 3.3V. The regulator worked. We removed the shunt on J99 which connected the grounds, and properly reshunted J5. VCC and ground were checked at the pins of the IC&rsquo;s at the board. Once the proper voltages were confirmed, the chips were reinserted. </span></li></ol><p class="c1"><span class="c3 c2"></span></p><ol class="c34 lst-kix_zf9przpwvhgy-0" start="8"><li class="c19 c14 li-bullet-0"><span class="c3 c2">We could finally test on a human subject. This yielded the following output seen in 2.a.iii.</span></li></ol><p class="c1"><span class="c3 c2"></span></p><h5 class="c29" id="h.jnc5dn6hqqvx"><span class="c3 c37">i. Testing Difficulties</span></h5><p class="c9 c12"><span class="c3 c21"></span></p><p class="c13"><span class="c3 c2">When working with our ECG board, we experienced a decent amount of noise when testing our components. Although this made it difficult to read and confirm measurements, we were able to make the situation better by minimizing our usage of the breadboard (amount of jumper wires used, etc.) to create a more direct connection between the probes and the ECG board. Also, different areas of the rooms yielded different amounts of noise, which was most probably a result of small EMF interferences with the board that vary based on the location in the room.</span></p><p class="c1"><span class="c3 c2"></span></p><p class="c13"><span class="c2">Additionally, when testing the filter, our plan was to test the two 2</span><span class="c2 c67">nd</span><span class="c2">&nbsp;order filters separately before testing the complete response. Our frequency response was not showing up properly for individual filter tests, and upon performing a continuity test with the multimeter, we found that test pin </span><span class="c2 c35">U19</span><span class="c2">&nbsp;(in between the two filters) was not connected to the output of the first filter or the input resistor </span><span class="c2 c35">R10</span><span class="c2">&nbsp;for the second filter. To work around this, we used alligator clips to connect directly to the midpoint of the filter (</span><span class="c2 c35">R10</span><span class="c3 c2">), and from there we were able to confirm the proper frequency responses for each of the filters.</span></p><p class="c1"><span class="c3 c2"></span></p><h5 class="c29" id="h.3f54vt6uff9o"><span class="c3 c37">ii. Differences between analytical design, simulations, and physical testing</span></h5><p class="c9 c12"><span class="c3 c21"></span></p><p class="c13"><span class="c3 c2">Differences between analytical work and numerical verifications were almost nonexistent. </span></p><p class="c1"><span class="c3 c2"></span></p><p class="c13"><span class="c3 c2">Some differences were observed when comparing numerical and experimental verification, which can be attributed to resistor error and difference in isolator transfer gain K3.</span></p><p class="c1"><span class="c3 c2"></span></p><p class="c13"><span class="c3 c2">The clearest way to see this error is in the filter, where the corner frequency in the experimental filter is found to be 5Hz less than the numerical. 58 Hz vs. 63 Hz. It is also likely that the gain of the op-amp is slightly different from numerical gain. However, this was not tested directly because of the AD2&rsquo;s difficulty to output small signals. What matters is that the gain was close enough to 1000, and thus yielded an output in the range of 1V to 2.5V. </span></p><p class="c1 c18"><span class="c3 c2"></span></p><p class="c13"><span class="c3 c2">Finally, the output of the isolator was slightly different when comparing numerical and experimental. The gain in the experimental verification seems to be slightly less than 1. This must mean that K3 was slightly smaller than what we assumed it to be numerically (less than 1.3).</span></p><p class="c1 c18"><span class="c3 c2"></span></p><p class="c39"><span class="c3 c27">a. Images</span></p><h5 class="c29" id="h.71p08d4tv7if"><span class="c3 c37">i. Test setup</span></h5><p class="c1"><span class="c3 c21"></span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: -0.00px -0.00px; border: 2.67px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 353.50px; height: 349.24px;"><img alt="" src="images/image49.png" style="width: 353.50px; height: 349.24px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c7"><span class="c3 c2">Figure 23. Experimental Setup</span></p><h5 class="c29" id="h.ltluj3fejblq"><span class="c37 c30">ii. Board</span></h5><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 1.33px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 365.95px; height: 287.12px;"><img alt="" src="images/image61.png" style="width: 365.95px; height: 287.12px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c7"><span class="c3 c2">Figure 24. Frontside of Board</span></p><p class="c7 c12"><span class="c3 c2"></span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 1.33px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 380.00px; height: 276.91px;"><img alt="" src="images/image38.png" style="width: 380.00px; height: 276.91px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c7"><span class="c2">Figure 25. Backside of Board</span></p><p class="c1"><span class="c3 c2"></span></p><h5 class="c29" id="h.kzh5sbta732r"><span class="c3 c37">iii. EKG Waveforms Output</span></h5><p class="c1"><span class="c3 c2"></span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: -0.00px -0.00px; border: 1.33px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 620.00px; height: 245.00px;"><img alt="" src="images/image66.png" style="width: 620.00px; height: 245.00px; margin-left: -0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c7"><span class="c2">Figure 25. EKG Output 1</span></p><h4 class="c58 c76" id="h.1f82njvi1ywa"><span class="c3 c27"></span></h4><p class="c7 c12"><span class="c3 c21"></span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px -0.00px; border: 1.33px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 677.20px; height: 268.00px;"><img alt="" src="images/image52.png" style="width: 682.00px; height: 268.00px; margin-left: -4.80px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c7"><span class="c3 c2">Figure 26. EKG Output 2</span></p><p class="c39"><span class="c3 c2">&nbsp;</span></p><p class="c13"><span class="c3 c2">Comparing Figure 25 and 26, we can notice that the heart rate for output 1 is faster than the heart rate for output 2. Output 1 had a period of about 0.85s which corresponds to a heart rate of 71 beats/min. Output two had a period of about 1.15s which corresponds to a heart rate of 52 beats/min. The amplitude of output 1 had a higher amplitude at each pulse, which we believe is due to a better connection between the electrodes and the skin of our subject, Quentin. Finally, we can conclude that Quentin Barnes Olsen has a healthy heart rate for a 20 year old man.</span></p><p class="c1 c18"><span class="c3 c2"></span></p><h4 class="c58" id="h.2vshoai032yt"><span class="c27 c30">a. Data Capture and Filtering</span></h4><p class="c13"><span class="c2">To design the FIR filter to eliminate 60Hz interference caused by ambient electromagnetic waves from nearby electronics, we followed the process outlined in the Moving Average Filters handout (</span><span class="c2">Reference </span><sup><a href="#cmnt1" id="cmnt_ref1">[a]</a></sup><span class="c3 c2">6). Our data had 8000 samples gathered at 1.6kHz samples per second. First, we calculated the length of the filter using the following process:</span></p><p class="c1"><span class="c3 c2"></span></p><p class="c7 c14"><img src="images/image22.png"></p><p class="c7 c14 c12"><span class="c3 c2"></span></p><p class="c7 c14"><span class="c3 c2">Solving for N:</span></p><p class="c7 c14"><img src="images/image23.png"></p><p class="c7 c14 c12"><span class="c3 c2"></span></p><p class="c7 c14"><span class="c3 c2">We know that</span></p><p class="c7 c14"><img src="images/image24.png"></p><p class="c1 c14"><span class="c3 c2"></span></p><p class="c39 c14"><span class="c2">Plugging these values in we get </span><img src="images/image25.png"></p><p class="c1 c18"><span class="c3 c2"></span></p><p class="c13"><span class="c2">Because we did not get a whole number, we had to implement two filters at the two nearest whole numbers to </span><img src="images/image25.png"><span class="c2">. Now we redo the above process but instead we are solving for </span><img src="images/image26.png"><span class="c2">&nbsp;given </span><img src="images/image27.png"><span class="c2">. The following formula was found by swapping N and </span><img src="images/image26.png"><span class="c3 c2">&nbsp;from the formula in the previous section:</span></p><p class="c1"><span class="c3 c2"></span></p><p class="c7"><img src="images/image28.png"></p><p class="c7"><img src="images/image29.png"><span class="c56">: </span><img src="images/image30.png"></p><p class="c7"><img src="images/image31.png"><span class="c56">: </span><img src="images/image32.png"></p><p class="c1 c14"><span class="c3 c2"></span></p><p class="c13"><span class="c3 c2">With these values, we created two kernels:</span></p><p class="c1"><span class="c3 c2"></span></p><p class="c0"><span class="c2">26 values equal to </span><img src="images/image33.png"><span class="c3 c2">/1600</span></p><p class="c0"><span class="c2">27 values equal to </span><img src="images/image34.png"><span class="c3 c2">/1600</span></p><p class="c1 c18"><span class="c3 c2"></span></p><p class="c13"><span class="c2">To get our final kernel, we convolved the two kernels together. With our final kernel, we applied the filter to the EKG data using a convolution to filter out the 60 Hz interference. The code is in </span><span class="c2">Appendix </span><span class="c3 c2">B. The results are shown in the following three figures. </span></p><p class="c1"><span class="c3 c2"></span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 472.00px; height: 307.99px;"><img alt="" src="images/image35.png" style="width: 472.00px; height: 307.99px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c7"><span class="c3 c2">Figure 28: Original vs Filtered EKG Data 1</span></p><p class="c7 c12"><span class="c3 c2"></span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 488.00px; height: 315.43px;"><img alt="" src="images/image45.png" style="width: 488.00px; height: 315.43px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c7"><span class="c3 c2">Figure 29: Original vs Filtered EKG Data 2</span></p><p class="c1"><span class="c3 c2"></span></p><p class="c1"><span class="c3 c2"></span></p><p class="c13"><span class="c3 c2">Looking at Figures 28-29, we can see that the FIR filter successfully removed 60Hz signals from the data, producing a much cleaner output. A graph with only the filtered data is shown below:</span></p><p class="c1"><span class="c3 c2"></span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 451.30px; height: 291.16px;"><img alt="" src="images/image50.png" style="width: 451.30px; height: 291.16px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c7"><span class="c2">Figure 30: Filtered EKG Data </span></p><h3 class="c65" id="h.9c30csk9vetg"><span class="c70 c30">Conclusions</span></h3><h4 class="c58" id="h.nkp8aibnuynf"><span class="c3 c27">a. Flow of work, design decisions, and resources used</span></h4><p class="c9 c12"><span class="c3 c21"></span></p><p class="c13"><span class="c3 c2">The learning curve to understand the EKG&rsquo;s functionality made the project feel very slow initially, and very fast-moving once the boards were brought back and testing began. Thankfully, few major roadblocks were met other than large amounts of interference when testing the EKG with a human subject. This made the flow of work consistent and fluid. </span></p><p class="c1"><span class="c3 c2"></span></p><p class="c13"><span class="c3 c2">Given the requirements provided, very few design decisions were actually made. Firstly was the layout. Its design is described above and thoroughly explained. The only other major design decision was the choice of not installing R12, a resistor that set the gain on the isolator. This was done because K3 was the largest variable in our circuit. Given that it could vary so much, we wanted to be able to change R12 to a lower value if K3 was larger than expected, and to a lower value if K3 was smaller than expected. </span></p><p class="c1"><span class="c3 c2"></span></p><p class="c13"><span class="c3 c2">Resources are shown in the References section. Datasheets proved to be the most vital resource to this project. The Op-Amp datasheet was referenced numerous times to confirm maximum output current and voltage. The In&ndash;Amp data sheet was referenced to calculate the gain, and verify that it was possible given its maximum gain rating. We were provided with two useful documents for the isolator. The first noted K3 values and characteristics of the isolator. The second provided us with its implementation and equations that calculated gain and output current. Finally, some very useful documents were referenced to design the low-pass filters. Texas Instruments write-up of &ldquo;Active Low-Pass Filter Design&rdquo; provides a useful simplification that was implemented when writing the code to design the filters. </span></p><h4 class="c31" id="h.3y6lqgc509e6"><span class="c3 c27">b. Project Future Improvements</span></h4><h4 class="c31 c18" id="h.hjxkmv5qrfx3"><span class="c2 c30">Our only comment would be that understanding the isolator was extremely difficult. We feel as if we would have learned more if it was taught to us, rather than having to understand its functionality through the datasheets. The truth is that the isolator has many different uses, and its usage in a medical device is not mentioned in the datasheet. On top of this, resources online were sparse. Because of this, the isolator system was designed to be functional without being fully understood. This might be a task we might face in the </span><span class="c30 c72">professional</span><span class="c2 c30">&nbsp;world, but it would make sense to learn about a new component, given that we are already most of the way there. </span></h4><hr style="page-break-before:always;display:none;"><h3 class="c36" id="h.kkn1576bz79k"><span class="c3 c38"></span></h3><h3 class="c65" id="h.7usjaqg1fgk5"><span class="c30 c70">References</span></h3><p class="c39"><span class="c3 c2">[1]</span></p><p class="c20"><span class="c2">Analog Devices (AD), &ldquo;Data Sheet: AD623.&rdquo; [Online]. Available:</span><span class="c2"><a class="c42" href="https://www.google.com/url?q=https://collab.its.virginia.edu/access/content/group/f8a79dcf-aef2-41da-91ac-bc4cb4357fb1/Reading%2520Materials/sloa024b.pdf&amp;sa=D&amp;source=editors&amp;ust=1707275233279155&amp;usg=AOvVaw1T5hCYgrIUpakxK7oc8DSx">&nbsp;</a></span><span class="c17 c2"><a class="c42" href="https://www.google.com/url?q=https://collab.its.virginia.edu/access/content/group/f8a79dcf-aef2-41da-91ac-bc4cb4357fb1/Project%2520Materials%2520F23/Components/AD623.pdf&amp;sa=D&amp;source=editors&amp;ust=1707275233279481&amp;usg=AOvVaw22_oyfmYokuDYBs2TxshfA">https://collab.its.virginia.edu/access/content/group/f8a79dcf-aef2-41da-91ac-bc4cb4357fb1/Project%20Materials%20F23/Components/AD623.pdf</a></span></p><p class="c1 c41"><span class="c3 c21"></span></p><p class="c20 c12"><span class="c3 c21"></span></p><p class="c39"><span class="c3 c2">[2]</span></p><p class="c20"><span class="c2">Texas Instruments (TI), &ldquo;Analysis of the Sallen-Key Architecture.&rdquo; [Online]. Available:</span><span class="c2"><a class="c42" href="https://www.google.com/url?q=https://collab.its.virginia.edu/access/content/group/f8a79dcf-aef2-41da-91ac-bc4cb4357fb1/Reading%2520Materials/sloa024b.pdf&amp;sa=D&amp;source=editors&amp;ust=1707275233279861&amp;usg=AOvVaw0ijgeTQQBDo-gBsQ3o_NZm">&nbsp;</a></span><span class="c17 c2"><a class="c42" href="https://www.google.com/url?q=https://collab.its.virginia.edu/access/content/group/f8a79dcf-aef2-41da-91ac-bc4cb4357fb1/Reading%2520Materials/sloa024b.pdf&amp;sa=D&amp;source=editors&amp;ust=1707275233280039&amp;usg=AOvVaw1T28HFxzE0d-7hGsmmTZ5Q">https://collab.its.virginia.edu/access/content/group/f8a79dcf-aef2-41da-91ac-bc4cb4357fb1/Reading%20Materials/sloa024b.pdf</a></span></p><p class="c1"><span class="c3 c2"></span></p><p class="c39"><span class="c3 c2">[3]</span></p><p class="c20"><span class="c2">Vishay Semiconductors, &ldquo;IL300: Linear Optocoupler, High Gain Stability, Wide Bandwidth.&rdquo; [Online]. Available:</span><span class="c2"><a class="c42" href="https://www.google.com/url?q=https://collab.its.virginia.edu/access/content/group/f8a79dcf-aef2-41da-91ac-bc4cb4357fb1/Reading%2520Materials/sloa024b.pdf&amp;sa=D&amp;source=editors&amp;ust=1707275233280345&amp;usg=AOvVaw0xEfYJbAJ7yMAbXYuNUAPp">&nbsp;</a></span><span class="c17 c2"><a class="c42" href="https://www.google.com/url?q=https://collab.its.virginia.edu/access/content/group/f8a79dcf-aef2-41da-91ac-bc4cb4357fb1/Project%2520Materials%2520F23/Components/Isolator%2520Info/il300.pdf&amp;sa=D&amp;source=editors&amp;ust=1707275233280531&amp;usg=AOvVaw1Hz1JQC5v9HNlbdwdmpLrE">https://collab.its.virginia.edu/access/content/group/f8a79dcf-aef2-41da-91ac-bc4cb4357fb1/Project%20Materials%20F23/Components/Isolator%20Info/il300.pdf</a></span></p><p class="c1"><span class="c3 c2"></span></p><p class="c39"><span class="c3 c2">[4]</span></p><p class="c20"><span class="c2">Texas Instruments (TI), &ldquo;LMC6482 CMOS Dual Rail-to-Rail Input and Output Operational Amplifier.&rdquo; [Online]. Available:</span><span class="c2"><a class="c42" href="https://www.google.com/url?q=https://collab.its.virginia.edu/access/content/group/f8a79dcf-aef2-41da-91ac-bc4cb4357fb1/Reading%2520Materials/sloa024b.pdf&amp;sa=D&amp;source=editors&amp;ust=1707275233280882&amp;usg=AOvVaw12wejRBKJRXhvM2y3BWoBy">&nbsp;</a></span><span class="c17 c2"><a class="c42" href="https://www.google.com/url?q=https://collab.its.virginia.edu/access/content/group/f8a79dcf-aef2-41da-91ac-bc4cb4357fb1/Project%2520Materials%2520F23/Components/lmc6482.pdf&amp;sa=D&amp;source=editors&amp;ust=1707275233281124&amp;usg=AOvVaw35a4Al2pWL7MZRxh-sTvvT">https://collab.its.virginia.edu/access/content/group/f8a79dcf-aef2-41da-91ac-bc4cb4357fb1/Project%20Materials%20F23/Components/lmc6482.pdf</a></span></p><p class="c1 c41"><span class="c3 c2"></span></p><p class="c39"><span class="c2 c3">[5]</span></p><p class="c20"><span class="c2">Prof. Powell, &ldquo;Submitting Board Files to FreeDFM.&rdquo; [Online]. Available:</span><span class="c2"><a class="c42" href="https://www.google.com/url?q=https://collab.its.virginia.edu/access/content/group/f8a79dcf-aef2-41da-91ac-bc4cb4357fb1/Reading%2520Materials/sloa024b.pdf&amp;sa=D&amp;source=editors&amp;ust=1707275233281433&amp;usg=AOvVaw3ev3zMVCqA7HNb57BPEOBa">&nbsp;</a></span><span class="c2 c17"><a class="c42" href="https://www.google.com/url?q=https://collab.its.virginia.edu/access/content/group/f8a79dcf-aef2-41da-91ac-bc4cb4357fb1/Project%2520Materials%2520F23/Submission%2520Info%252022/Submitting%2520to%2520FreeDFM%2520S21.pdf&amp;sa=D&amp;source=editors&amp;ust=1707275233281626&amp;usg=AOvVaw2lNGdmvEj73syKJXgbEbOH">https://collab.its.virginia.edu/access/content/group/f8a79dcf-aef2-41da-91ac-bc4cb4357fb1/Project%20Materials%20F23/Submission%20Info%2022/Submitting%20to%20FreeDFM%20S21.pdf</a></span></p><p class="c12 c41 c64"><span class="c3 c2"></span></p><p class="c64 c41"><span class="c3 c2">[6]</span></p><p class="c64 c41 c71"><span class="c2">Prof. Powell, &ldquo;Discrete Filters 1.&rdquo; [Online]. Available:</span><span class="c2"><a class="c42" href="https://www.google.com/url?q=https://collab.its.virginia.edu/access/content/group/f8a79dcf-aef2-41da-91ac-bc4cb4357fb1/Reading%2520Materials/Discrete%2520Filters%25201.pdf&amp;sa=D&amp;source=editors&amp;ust=1707275233281969&amp;usg=AOvVaw13KdeGWiGX3URGK-hYex3f">&nbsp;</a></span><span class="c17 c2"><a class="c42" href="https://www.google.com/url?q=https://collab.its.virginia.edu/access/content/group/f8a79dcf-aef2-41da-91ac-bc4cb4357fb1/Reading%2520Materials/Discrete%2520Filters%25201.pdf&amp;sa=D&amp;source=editors&amp;ust=1707275233282176&amp;usg=AOvVaw0fz-FyuLfkvdtTl0LTKya0">https://collab.its.virginia.edu/access/content/group/f8a79dcf-aef2-41da-91ac-bc4cb4357fb1/Reading%20Materials/Discrete%20Filters%201.pdf</a></span></p><hr style="page-break-before:always;display:none;"><p class="c20 c12"><span class="c3 c2"></span></p><h3 class="c28" id="h.jxidle6xgh7c"><span class="c3 c37">Appendix A - Sallen Key low Pass Filter Design Code</span></h3><p class="c9 c12"><span class="c3 c21"></span></p><p class="c9"><span class="c3 c5">clear;</span></p><p class="c9"><span class="c3 c5">resistor_values_in_lab_kit = [10, 12, 15, 18, 22, 27, 33, 39, 47, 56, 68, 82, 100, 120, 150, 180, 220, 270, 330, 390, 470, 560, 680, 820, 1e3, 1.2e3, 1.5e3, 1.8e3, 2.2e3, 2.7e3, 3.3e3, 3.9e3, 4.7e3, 5.6e3, 6.8e3, 8.2e3, 10e3, 12e3, 15e3, 18e3, 22e3, 27e3, 33e3, 39e3, 47e3, 56e3, 68e3, 82e3, 100e3, 120e3, 150e3, 180e3, 220e3, 270e3, 330e3, 390e3, 470e3, 560e3, 680e3, 820e3, 1e6];</span></p><p class="c9"><span class="c3 c5">capacitor_values_in_kit = [0.01e-6, 0.1e-6, 0.47e-6, 1e-6, 4.7e-6, 10e-6, 100e-6, 220e-12];</span></p><p class="c9"><span class="c3 c5">q1_desired = 0.5412;</span></p><p class="c9"><span class="c3 c5">tolerance_q = 50e-3;</span></p><p class="c9"><span class="c3 c5">f_desired = 63;</span></p><p class="c9"><span class="c3 c5">tolerance_f = 5;</span></p><p class="c9"><span class="c3 c5">R1 = resistor_values_in_lab_kit;</span></p><p class="c9"><span class="c3 c5">R2 = resistor_values_in_lab_kit;</span></p><p class="c9"><span class="c3 c5">C1 = capacitor_values_in_kit;</span></p><p class="c9"><span class="c3 c5">C2 = capacitor_values_in_kit;</span></p><p class="c9"><span class="c5 c32">for </span><span class="c3 c5">i=1:length(R1)</span></p><p class="c9"><span class="c5 c32">for </span><span class="c3 c5">j=1:length(R2)</span></p><p class="c9"><span class="c5 c32">for </span><span class="c3 c5">k=1:length(C1)</span></p><p class="c9"><span class="c5 c32">for </span><span class="c3 c5">l=1:length(C2)</span></p><p class="c9"><span class="c3 c5">m1 = R1(i)/R2(j);</span></p><p class="c9"><span class="c3 c5">n1 = C2(l)/C1(k);</span></p><p class="c9"><span class="c3 c5">q1 = sqrt(m1*n1)/(m1+1);</span></p><p class="c9"><span class="c3 c5">f1 = 1/(2*pi*R2(j)*C1(k)*sqrt(m1*n1));</span></p><p class="c9"><span class="c5 c32">if </span><span class="c3 c5">(q1_desired - tolerance_q &lt;= q1 &amp;&amp; q1 &lt;= q1_desired + tolerance_q)</span></p><p class="c9"><span class="c5 c32">if </span><span class="c3 c5">(f_desired - tolerance_f &lt;= f1 &amp;&amp; f1 &lt;= f_desired + tolerance_f)</span></p><p class="c9"><span class="c5 c32">if </span><span class="c3 c5">(R1(i) &gt;= 47000 &amp;&amp; R2(j) &gt;= 47000)</span></p><p class="c9"><span class="c5">fprintf(</span><span class="c5 c73">&#39;R1: %f, R2: %f, C1: %s, C2: %s, q: %s, f: %s \n&#39;</span><span class="c3 c5">, R1(i), R2(j), C1(k), C2(l), q1, f1);</span></p><p class="c9"><span class="c6 c5">end</span></p><p class="c9"><span class="c6 c5">end</span></p><p class="c9"><span class="c6 c5">end</span></p><p class="c9"><span class="c6 c5">end</span></p><p class="c9"><span class="c6 c5">end</span></p><p class="c9"><span class="c5 c6">end</span></p><p class="c9"><span class="c6 c5">end</span></p><p class="c9"><span class="c3 c5">q2_desired = 1.3065;</span></p><p class="c9"><span class="c3 c5">tolerance_q2 = 50e-3;</span></p><p class="c9"><span class="c3 c5">R3 = resistor_values_in_lab_kit;</span></p><p class="c9"><span class="c3 c5">R4 = resistor_values_in_lab_kit;</span></p><p class="c9"><span class="c3 c5">C3 = capacitor_values_in_kit;</span></p><p class="c9"><span class="c3 c5">C4 = capacitor_values_in_kit;</span></p><p class="c9"><span class="c5 c32">for </span><span class="c3 c5">m=1:length(R3)</span></p><p class="c9"><span class="c5 c32">for </span><span class="c3 c5">n=1:length(R4)</span></p><p class="c9"><span class="c5 c32">for </span><span class="c3 c5">o=1:length(C3)</span></p><p class="c9"><span class="c5 c32">for </span><span class="c3 c5">p=1:length(C4)</span></p><p class="c9"><span class="c3 c5">m2 = R3(m)/R4(n);</span></p><p class="c9"><span class="c3 c5">n2 = C4(p)/C3(o);</span></p><p class="c9"><span class="c3 c5">q2 = sqrt(m2*n2)/(m2+1);</span></p><p class="c9"><span class="c3 c5">f2 = 1/(2*pi*R4(n)*C3(o)*sqrt(m2*n2));</span></p><p class="c9"><span class="c5 c32">if </span><span class="c3 c5">(q2_desired - tolerance_q2 &lt;= q2 &amp;&amp; q2 &lt;= q2_desired + tolerance_q2)</span></p><p class="c9"><span class="c5 c32">if </span><span class="c3 c5">(f_desired - tolerance_f &lt;= f2 &amp;&amp; f2 &lt;= f_desired + tolerance_f)</span></p><p class="c9"><span class="c5 c32">if </span><span class="c3 c5">(R3(m) &gt;= 47000 &amp;&amp; R4(n) &gt;= 47000)</span></p><p class="c9"><span class="c5">fprintf(</span><span class="c5 c73">&#39;R3: %f, R4: %f, C3: %s, C4: %s, q: %s, f: %s \n&#39;</span><span class="c3 c5">, R3(m), R4(n), C3(o), C4(p), q2, f2);</span></p><p class="c9"><span class="c6 c5">end</span></p><p class="c9"><span class="c6 c5">end</span></p><p class="c9"><span class="c6 c5">end</span></p><p class="c9"><span class="c6 c5">end</span></p><p class="c9"><span class="c6 c5">end</span></p><p class="c9"><span class="c6 c5">end</span></p><p class="c9"><span class="c6 c5">end</span></p><p class="c9 c12"><span class="c3 c21"></span></p><h3 class="c28" id="h.yuqswyyfdzxt"><span class="c37 c30">Appendix B - Moving Average FIR Filter Python Code</span></h3><p class="c15"><span class="c60">import</span><span class="c4">&nbsp;</span><span class="c24">numpy</span><span class="c4">&nbsp;</span><span class="c60">as</span><span class="c4">&nbsp;</span><span class="c24 c8">np</span></p><p class="c15"><span class="c60">import</span><span class="c4">&nbsp;</span><span class="c24">pandas</span><span class="c4">&nbsp;</span><span class="c60">as</span><span class="c4">&nbsp;</span><span class="c24 c8">pd</span></p><p class="c15"><span class="c60">import</span><span class="c4">&nbsp;</span><span class="c24">matplotlib</span><span class="c4">.</span><span class="c24">pyplot</span><span class="c4">&nbsp;</span><span class="c60">as</span><span class="c4">&nbsp;</span><span class="c24 c8">plt</span></p><p class="c1 c33"><span class="c4 c8"></span></p><p class="c15"><span class="c8 c66"># Load data from Excel file</span></p><p class="c15"><span class="c11">file_path</span><span class="c4">&nbsp;</span><span class="c10">=</span><span class="c4">&nbsp;</span><span class="c22 c8">&#39;HW6/ekg_data.xlsx&#39;</span></p><p class="c15"><span class="c11">sheet_name</span><span class="c4">&nbsp;</span><span class="c10">=</span><span class="c4">&nbsp;</span><span class="c22 c8">&#39;Sheet3&#39;</span></p><p class="c15"><span class="c11">df</span><span class="c4">&nbsp;</span><span class="c10">=</span><span class="c4">&nbsp;</span><span class="c24">pd</span><span class="c4">.</span><span class="c23">read_excel</span><span class="c4">(</span><span class="c11">file_path</span><span class="c4">, </span><span class="c11">sheet_name</span><span class="c10">=</span><span class="c11">sheet_name</span><span class="c4 c8">)</span></p><p class="c1 c33"><span class="c4 c8"></span></p><p class="c15"><span class="c66 c8"># Extract data from DataFrame</span></p><p class="c15"><span class="c11">time</span><span class="c4">&nbsp;</span><span class="c10">=</span><span class="c4">&nbsp;</span><span class="c11">df</span><span class="c4">[</span><span class="c22">&#39;Time&#39;</span><span class="c4 c8">]</span></p><p class="c15"><span class="c11">voltages</span><span class="c4">&nbsp;</span><span class="c10">=</span><span class="c4">&nbsp;</span><span class="c11">df</span><span class="c4">[</span><span class="c22">&#39;Voltage&#39;</span><span class="c4 c8">]</span></p><p class="c1 c33"><span class="c4 c8"></span></p><p class="c15"><span class="c11">fs</span><span class="c4">&nbsp;</span><span class="c10">=</span><span class="c4">&nbsp;</span><span class="c53">1600</span><span class="c4">&nbsp; </span><span class="c66 c8"># Sampling frequency in Hz</span></p><p class="c1 c33"><span class="c4 c8"></span></p><p class="c15"><span class="c66 c8">#creating the two kernels</span></p><p class="c15"><span class="c11">fc_61</span><span class="c4">&nbsp;</span><span class="c10">=</span><span class="c4">&nbsp;</span><span class="c53 c8">61.5384615385</span></p><p class="c15"><span class="c11">fc_59</span><span class="c4">&nbsp;</span><span class="c10">=</span><span class="c4">&nbsp;</span><span class="c53 c8">59.2592592593</span></p><p class="c1 c33"><span class="c4 c8"></span></p><p class="c15"><span class="c11">kernel_61</span><span class="c4">&nbsp;</span><span class="c10">=</span><span class="c4 c8">&nbsp;[]</span></p><p class="c15"><span class="c11">kernel_61_values</span><span class="c4">&nbsp;</span><span class="c10">=</span><span class="c4">&nbsp;</span><span class="c11">fc_61</span><span class="c4">&nbsp;</span><span class="c10">/</span><span class="c4">&nbsp;</span><span class="c8 c11">fs</span></p><p class="c1 c33"><span class="c4 c8"></span></p><p class="c15"><span class="c11">kernel_59</span><span class="c4">&nbsp;</span><span class="c10">=</span><span class="c4 c8">&nbsp;[]</span></p><p class="c15"><span class="c11">kernel_59_values</span><span class="c4">&nbsp;</span><span class="c10">=</span><span class="c4">&nbsp;</span><span class="c11">fc_59</span><span class="c4">&nbsp;</span><span class="c10">/</span><span class="c4">&nbsp;</span><span class="c11 c8">fs</span></p><p class="c1 c33"><span class="c4 c8"></span></p><p class="c15"><span class="c60">for</span><span class="c4">&nbsp;</span><span class="c11">i</span><span class="c4">&nbsp;</span><span class="c60">in</span><span class="c4">&nbsp;</span><span class="c24">range</span><span class="c4">(</span><span class="c53">26</span><span class="c4 c8">):</span></p><p class="c15"><span class="c4">&nbsp; &nbsp;</span><span class="c11">kernel_61</span><span class="c4">.</span><span class="c23">append</span><span class="c4">(</span><span class="c11">kernel_61_values</span><span class="c4 c8">)</span></p><p class="c1 c33"><span class="c4 c8"></span></p><p class="c15"><span class="c60">for</span><span class="c4">&nbsp;</span><span class="c11">i</span><span class="c4">&nbsp;</span><span class="c60">in</span><span class="c4">&nbsp;</span><span class="c24">range</span><span class="c4">(</span><span class="c53">27</span><span class="c4 c8">):</span></p><p class="c15"><span class="c4">&nbsp; &nbsp;</span><span class="c11">kernel_59</span><span class="c4">.</span><span class="c23">append</span><span class="c4">(</span><span class="c11">kernel_59_values</span><span class="c4 c8">)</span></p><p class="c1 c33"><span class="c4 c8"></span></p><p class="c15"><span class="c66 c8">#combining the two kernels</span></p><p class="c15"><span class="c11">combined_kernel</span><span class="c4">&nbsp;</span><span class="c10">=</span><span class="c4">&nbsp;</span><span class="c24">np</span><span class="c4">.</span><span class="c23">convolve</span><span class="c4">(</span><span class="c11">kernel_59</span><span class="c4">, </span><span class="c11">kernel_61</span><span class="c4 c8">)</span></p><p class="c1 c33"><span class="c4 c8"></span></p><p class="c15"><span class="c11">filtered_ekg_data</span><span class="c4">&nbsp;</span><span class="c10">=</span><span class="c4">&nbsp;</span><span class="c24">np</span><span class="c4">.</span><span class="c23">convolve</span><span class="c4">(</span><span class="c11">voltages</span><span class="c4">, </span><span class="c11">combined_kernel</span><span class="c4">, </span><span class="c11">mode</span><span class="c10">=</span><span class="c22">&#39;same&#39;</span><span class="c4 c8">)</span></p><p class="c1 c33"><span class="c4 c8"></span></p><p class="c15"><span class="c66 c8"># Plot the data</span></p><p class="c15"><span class="c24">plt</span><span class="c4">.</span><span class="c23">figure</span><span class="c4">(</span><span class="c11">figsize</span><span class="c10">=</span><span class="c4">(</span><span class="c53">10</span><span class="c4">, </span><span class="c53">6</span><span class="c4 c8">))</span></p><p class="c15"><span class="c24">plt</span><span class="c4">.</span><span class="c23">plot</span><span class="c4">(</span><span class="c11">time</span><span class="c4">[</span><span class="c53">20</span><span class="c4">:</span><span class="c10">-</span><span class="c53">20</span><span class="c4">], </span><span class="c11">voltages</span><span class="c4">[</span><span class="c53">20</span><span class="c4">:</span><span class="c10">-</span><span class="c53">20</span><span class="c4">], </span><span class="c11">label</span><span class="c10">=</span><span class="c22">&#39;Original EKG Data&#39;</span><span class="c4 c8">)</span></p><p class="c15"><span class="c24">plt</span><span class="c4">.</span><span class="c23">plot</span><span class="c4">(</span><span class="c11">time</span><span class="c4">[</span><span class="c53">20</span><span class="c4">:</span><span class="c10">-</span><span class="c53">20</span><span class="c4">], </span><span class="c11">filtered_ekg_data</span><span class="c4">[</span><span class="c53">20</span><span class="c4">:</span><span class="c10">-</span><span class="c53">20</span><span class="c4">], </span><span class="c11">label</span><span class="c10">=</span><span class="c22">&#39;Filtered EKG Data&#39;</span><span class="c4 c8">)</span></p><p class="c15"><span class="c24">plt</span><span class="c4">.</span><span class="c23">title</span><span class="c4">(</span><span class="c22">&#39;Original and Filtered EKG Data&#39;</span><span class="c4 c8">)</span></p><p class="c15"><span class="c24">plt</span><span class="c4">.</span><span class="c23">xlabel</span><span class="c4">(</span><span class="c22">&#39;Time&#39;</span><span class="c4 c8">)</span></p><p class="c15"><span class="c24">plt</span><span class="c4">.</span><span class="c23">ylabel</span><span class="c4">(</span><span class="c22">&#39;Value&#39;</span><span class="c4 c8">)</span></p><p class="c15"><span class="c24">plt</span><span class="c4">.</span><span class="c23">legend</span><span class="c4 c8">()</span></p><p class="c15"><span class="c24">plt</span><span class="c4">.</span><span class="c23">show</span><span class="c4 c8">()</span></p><p class="c46 c12"><span class="c3 c21"></span></p><p class="c12 c46"><span class="c3 c21"></span></p><p class="c12 c52"><span class="c3 c2"></span></p><p class="c52"><span class="c3 c2">&nbsp;</span></p><p class="c52"><span class="c3 c2">&nbsp;</span></p><p class="c9 c12"><span class="c3 c21"></span></p><p class="c20 c12"><span class="c3 c37"></span></p><p class="c20 c12"><span class="c3 c2"></span></p><p class="c1"><span class="c3 c2"></span></p><p class="c1"><span class="c3 c59"></span></p><p class="c1"><span class="c3 c59"></span></p><div class="c44"><p class="c69"><a href="#cmnt_ref1" id="cmnt1">[a]</a><span class="c3 c21">https://collab.its.virginia.edu/access/content/group/f8a79dcf-aef2-41da-91ac-bc4cb4357fb1/Reading%20Materials/Discrete%20Filters%201.pdf</span></p></div></body></html>